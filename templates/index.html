{% extends 'base.html' %}

{% block title %}
  List of files
{% endblock %}

{% block header %}
  List of files on the server
{% endblock %}

{% block body %}

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{category}} row justify-content-center">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}
{% endwith %}

  <div class="container">
    <div class="row">
      <div class="col-sm-11">
        <table class="table table">
          <tbody>
            {% for file in files %}
              <tr>
                <td>{{ file }}</td>
                <td><button type="button" class="btn btn-danger btn-sm m-1" data-toggle="modal" data-target="#deleteModal">Delete File</button>

                      <!-- Modal -->
                  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title" id="deleteModalLabel">Delete file?</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <form action="{{ url_for('delete_file', file_name=file) }}" method="POST">
                              <input class="btn btn-danger" type="submit" value="Delete">
                            </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>
                <td> <a class="btn btn-secondary btn-sm mt-1 mb-1" href="{{ url_for('read_file', file_name=file) }}">Read file</a> </td>
                <td> <a class='btn btn-secondary btn-sm mt-1 mb-1 {{"visible" if ".txt" in file else "invisible"}} '
                href="{{ url_for('update_file', file_name=file) }}">Update content</a> </td>
                <td> <a class="btn btn-secondary btn-sm mt-1 mb-1" href="{{ url_for('get_meta_data', file_name=file) }}">Get meta data of the file</a> </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

{% endblock %}